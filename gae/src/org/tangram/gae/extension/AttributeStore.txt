package org.tangram.gae.extension;

import java.util.Collection;
import java.util.HashSet;
import java.util.List;

import javax.jdo.JDOHelper;
import javax.jdo.PersistenceManager;
import javax.jdo.PersistenceManagerFactory;
import javax.jdo.Query;

public class AttributeStore {

    public static final PersistenceManagerFactory pmfInstance = JDOHelper
            .getPersistenceManagerFactory("transactions-optional");


    public Collection<Object> getValues(String contentId, String customerId, String key) {
        Collection<Object> result = new HashSet<Object>();

        PersistenceManager manager = pmfInstance.getPersistenceManager();
        
        Query query = manager.newQuery(ExtendedAttribute.class, "");
        
        @SuppressWarnings("unchecked")
        List<ExtendedAttribute> attributes = (List<ExtendedAttribute>)query.execute();
        
        for (ExtendedAttribute attribute : attributes) {
            result.add(attribute.getValue().getValue());
        } // for
        
        return result;
    } // getValues()


    public void setValues(String contentId, String customerId, String key, Collection<Object> values) {
    } // setValues()

} // AttributeStore()
